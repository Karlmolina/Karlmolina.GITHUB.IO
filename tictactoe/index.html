<link href="https://fonts.googleapis.com/css?family=Varela+Round&display=swap" rel="stylesheet">
<style>
    body {
        margin: auto;
    }

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.10.2/p5.min.js"></script>
<script>
    let pointList;
    let xList = [];
    let oList = [];
    let playerOneTurn = true;


    function setup() {
        createCanvas(windowWidth, windowHeight);
        textAlign(CENTER, CENTER);
        colorMode(HSB, 255);
        textFont('Varela Round');

        updateSketch();
    }

    function updateSketch() {
        background(255);
        minSize = min(windowWidth, windowHeight);
        textSize(minSize / 2.5);
        strokeWeight(minSize / 40);
        pointList = [];
        const amount = 3;
        for (let i = 0; i < amount; i++) {
            for (let j = 0; j < amount; j++) {
                pointList.push(
                    createVector(i / amount * windowWidth + 1 / 6 * windowWidth, j / amount * windowHeight + .2 * windowHeight)
                );
            }
        }
    }

    function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
        updateSketch();
    }

    function draw() {
        background(255);
        line(1 / 3 * windowWidth, 0, 1 / 3 * windowWidth, windowHeight);
        line(2 / 3 * windowWidth, 0, 2 / 3 * windowWidth, windowHeight);
        line(0, 1 / 3 * windowHeight, windowWidth, 1 / 3 * windowHeight);
        line(0, 2 / 3 * windowHeight, windowWidth, 2 / 3 * windowHeight);

        //line(0, i/3*windowWidth, 0, j/3*windowHeight);

        pointList.forEach(p => {
            //ellipse(p.x, p.y, 10, 10);
        });

        if (playerOneTurn) {
            text('O', mouseX, mouseY);
        } else {
            text('X', mouseX, mouseY);
        }

        oList.forEach(i => {
            const point = pointList[i];
            text('O', point.x, point.y);
        });

        xList.forEach(i => {
            const point = pointList[i];
            text('X', point.x, point.y);
        });
    }

    function mousePressed() {
        let minDist = 100000;
        let minIndex = 0;
        for (let i = 0; i < pointList.length; i++) {
            const point = pointList[i];
            const dist = point.dist(createVector(mouseX, mouseY));
            if (dist < minDist) {
                minDist = dist;
                minIndex = i;
            }
        }

        if (playerOneTurn) {
            if (!xList.includes(minIndex)) {
                oList.push(minIndex);
            }
        } else {
            if (!oList.includes(minIndex)) {
                xList.push(minIndex);
            }
        }

        playerOneTurn = !playerOneTurn;
    }

    function resetBoard() {
        oList = [];
        xList = [];
    }

    function keyPressed() {
        resetBoard();
    }

    function doubleClicked() {
        resetBoard();
    }

</script>

